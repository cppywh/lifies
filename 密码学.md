# æ•°å­¦æ–¹é¢

## ç®—æ³•

#### å¿«é€Ÿè®¡ç®—æ¨¡ $x^n\pm1$

**å¿«é€Ÿå¿ƒæ³•**x^n+1

- çœ‹åˆ° $x^n$ å°±ç”¨ $-1$ æ›¿æ¢ï¼›
- çœ‹åˆ° $x^{n+m}$ å°±æ¢æˆ $-x^m$ï¼›
- çœ‹åˆ° $x^{n+n+m}$ å°±æ¢æˆ $+x^m$ï¼›ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æ¬¡æ•° $< n$ã€‚

---

**å¤šé¡¹å¼ä¹˜æ³•å…¬å¼**

ç»™å®šä¸¤ä¸ª $n$ ç³»æ•°å¤šé¡¹å¼ $a,b$ï¼š
$$
a=\sum_{i=0}^{n-1} a_i x^i,\qquad
b=\sum_{i=0}^{n-1} b_i x^i.
$$

ä¸€èˆ¬ä¹˜æ³•å±•å¼€ï¼š
$$
a\cdot b=\sum_{i=0}^{n-1}\sum_{j=0}^{n-1} a_i\,b_j\,x^{\,i+j}.
$$

å½“å·¥ä½œåœ¨ $\mathbb Z[x]/(x^n-1)$ï¼ˆ**å¾ªç¯å·ç§¯**ï¼‰ï¼š
$$
a\cdot b \equiv
\sum_{i=0}^{n-1}\sum_{j=0}^{n-1-i} a_i\,b_j\,x^{\,i+j}
\;+\;
\sum_{j=1}^{n-1}\sum_{i=n-j}^{n-1} a_i\,b_j\,x^{\,i+j-n}
\pmod{x^n-1}.
$$

å½“å·¥ä½œåœ¨ $\mathbb Z[x]/(x^n+1)$ï¼ˆ**è´Ÿå¾ªç¯å·ç§¯**ï¼‰ï¼š
$$
a\cdot b \equiv
\sum_{i=0}^{n-1}\sum_{j=0}^{n-1-i} a_i\,b_j\,x^{\,i+j}
\;-\;
\sum_{j=1}^{n-1}\sum_{i=n-j}^{n-1} a_i\,b_j\,x^{\,i+j-n}
\pmod{x^n+1}.
$$
å‰é¢æ˜¯åŸå¼çš„i+j<né¡¹ï¼Œåé¢æ˜¯i+j>=né¡¹

**å‡ºç°ç‚¹**ï¼šå…¨åŒæ€åŠ å¯†Rq



#### å¤æ•°

å¤æ•°çš„è¡¨ç¤ºæ³•ï¼Œä¸¤ç§ï¼Œå¤å¹³é¢ï¼Œxè½´ä¸ºaï¼Œyè½´ç”¨æ ¹å·ä¸‹ï¼ˆ-1ï¼‰å¾—åˆ°iã€‚ä»¥åŠå¤æ•°ç”¨æ¨¡é•¿å’Œå¹…è§’æ±‚ä¹˜ç§¯ã€‚
$$
z_1=a+bi=r_1(\cos\theta_1+i\sin\theta_1),\qquad
z_2=c+di=r_2(\cos\theta_2+i\sin\theta_2).
$$

$$
\begin{aligned}
z_1z_2
&= r_1r_2(\cos\theta_1+i\sin\theta_1)(\cos\theta_2+i\sin\theta_2) \\
&= r_1r_2\Big[(\cos\theta_1\cos\theta_2-\sin\theta_1\sin\theta_2)
  + i(\sin\theta_1\cos\theta_2+\cos\theta_1\sin\theta_2)\Big] \\
&= r_1r_2\big(\cos(\theta_1+\theta_2)+i\sin(\theta_1+\theta_2)\big).
\end{aligned}
$$

![complex_plane](F:\typoraphoto\complex_plane.png)

#### æ¬§æ‹‰å…¬å¼

å‡ ä½•è¯æ˜ + çº§æ•°è¯æ˜

ç›®æ ‡ï¼šè¯æ˜
$$
e^{i\theta}=\cos\theta+i\sin\theta.
$$

---

ä¸€ã€å‡ ä½•è¯æ˜ï¼šå°æ­¥æ—‹è½¬å–æé™

**1) å¤æ•°ä¹˜ä»¥ $i$ æ˜¯é€†æ—¶é’ˆæ—‹è½¬ $90^\circ$**

å¯¹ $z=x+iy$ï¼Œ
$$
i z = i(x+iy) = -y + i x,
$$
å³å‘é‡ $(x,y)$ å˜ä¸º $(-y,x)$ï¼Œæ¨¡é•¿ä¸å˜ã€è§’åº¦ $+\pi/2$ã€‚

**2) ä¸€ä¸ªâ€œå¾ˆå°çš„æ—‹è½¬â€å¯ç”± $1+i\Delta$ è¿‘ä¼¼**

å¯¹ä»»æ„ $z=x+iy$ï¼Œ
$$
(1+i\Delta)z
=(x-y\Delta) + i(y+x\Delta),
$$
è¿™æ°æ˜¯æŠŠ $(x,y)$ æ—‹è½¬è§’åº¦ $\Delta$ çš„ä¸€é˜¶è¿‘ä¼¼ï¼ˆè¯¯å·®ä¸º $O(\Delta^2)$ï¼‰ã€‚å¹¶ä¸”æ¨¡é•¿ä¸º1
$$
|1+i\Delta|=\sqrt{1+\Delta^2}=1+O(\Delta^2).
$$

**3) æŠŠæ€»è§’åº¦ $\theta$ åˆ‡æˆ $n$ ä»½å°è§’ $\Delta=\theta/n$**

ä» $1$ å‡ºå‘ï¼Œè¿ç»­åš $n$ æ¬¡â€œå°æ—‹è½¬â€ï¼š
$$
z_n=\Big(1+\frac{i\theta}{n}\Big)^n.
$$

- **æ¨¡é•¿æ”¶æ•›åˆ° 1ï¼š**
  $$
  |z_n|=\Big(\sqrt{1+\frac{\theta^2}{n^2}}\Big)^{n}
  =\exp\!\Big(\frac{n}{2}\ln\big(1+\tfrac{\theta^2}{n^2}\big)\Big)
  \xrightarrow[n\to\infty]{}\exp(0)=1.
  $$

- **å¹…è§’ç´¯åŠ åˆ° $\theta$ï¼š**  
  $\arg(1+i\theta/n)=\arctan(\theta/n)=\theta/n+O(1/n^3)$ï¼Œ  
  $n$ æ¬¡ç›¸åŠ å¾—åˆ° $\theta+o(1)$ã€‚

å› æ­¤
$$
\lim_{n\to\infty}\Big(1+\frac{i\theta}{n}\Big)^n
= \text{ï¼ˆå•ä½åœ†ä¸Šè§’åº¦ $\theta$ çš„ç‚¹ï¼‰}
=\cos\theta+i\sin\theta.
$$

> ï¼ˆè¡¥çš„å‡ ä½•è¦ç‚¹ï¼‰**æŠŠ $\theta$ ç­‰åˆ†æˆ $n$ ä»½åï¼Œ$z_n$ æ˜¯å•ä½åœ†ä¸Šä¸€ä¸ª $n$ è¾¹å½¢çš„ç«¯ç‚¹**ï¼šæ¯ä¸€æ­¥ç”± $1+i\theta/n$ å¯¼è‡´å¾®å°æ—‹è½¬å’Œå‡ ä¹ä¸å˜çš„ç¼©æ”¾ï¼›å½“ $n\to\infty$ï¼Œå¤šè¾¹å½¢æé™å°±æ˜¯åœ†å¼§åˆ°è¾¾çš„ç‚¹ã€‚

---

äºŒã€çº§æ•°è¯æ˜ï¼ˆæ³°å‹’å±•å¼€ï¼‰

ç”¨å®å˜é‡çš„æ³°å‹’çº§æ•°ï¼ˆåœ¨æ•´ä¸ªå¤å¹³é¢ä¹Ÿæˆç«‹ï¼‰ï¼š
$$
e^x=\sum_{k=0}^{\infty}\frac{x^k}{k!},\quad
\cos x=\sum_{m=0}^{\infty}\frac{(-1)^m x^{2m}}{(2m)!},\quad
\sin x=\sum_{m=0}^{\infty}\frac{(-1)^m x^{2m+1}}{(2m+1)!}.
$$

ä»¤ $x=i\theta$ï¼Œé€é¡¹ä»£å…¥å¹¶æŒ‰å¥‡å¶æ¬¡åˆ†ç»„ï¼š
$$
\begin{aligned}
e^{i\theta}
&=\sum_{k=0}^{\infty}\frac{(i\theta)^k}{k!}
=\sum_{m=0}^{\infty}\frac{(i\theta)^{2m}}{(2m)!}
  +\sum_{m=0}^{\infty}\frac{(i\theta)^{2m+1}}{(2m+1)!} \\[2pt]
&=\sum_{m=0}^{\infty}\frac{(-1)^m\theta^{2m}}{(2m)!}
 + i\sum_{m=0}^{\infty}\frac{(-1)^m\theta^{2m+1}}{(2m+1)!} \\[2pt]
&=\cos\theta+i\sin\theta.
\end{aligned}
$$

---

ä¸‰ã€ä¸¤ä¸ªå¸¸ç”¨æ¨è®º

- å– $\theta=\pi$ï¼š$e^{i\pi}=\cos\pi+i\sin\pi=-1$ã€‚
- de Moivre å…¬å¼ï¼š$(\cos\theta+i\sin\theta)^n=\cos(n\theta)+i\sin(n\theta)$ã€‚

#### å‚…é‡Œå¶å˜æ¢ï¼ˆFFTï¼‰

[ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢.html](ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢.html) 

1. å®šä¹‰ä¸è¯„ä»·ï¼ˆDFT çŸ©é˜µï¼‰

è®¾ $n=2^m$ï¼Œ$\;\omega=e^{\frac{2\pi i}{n}}$ï¼ˆğ‘›æ¬¡å•ä½æ ¹æ˜¯æŒ‡èƒ½å¤Ÿæ»¡è¶³æ–¹ç¨‹ğ‘§^ğ‘›=1çš„å¤æ•°ï¼Œè¿™äº›å¤æ•°ä¸€å…±æœ‰ğ‘›ä¸ªå®ƒä»¬éƒ½åˆ†å¸ƒåœ¨å¤å¹³é¢çš„å•ä½åœ†ä¸Šï¼Œå¹¶ä¸”æ„æˆä¸€ä¸ªæ­£ ğ‘›è¾¹å½¢ï¼Œå®ƒä»¬æŠŠå•ä½åœ†ç­‰åˆ†æˆğ‘›ä¸ªéƒ¨åˆ†ï¼‰ã€‚

å¤šé¡¹å¼
$$
P(x)=\sum_{k=0}^{n-1} p_k x^k
$$
åœ¨ $n$ ä¸ª $n$ æ¬¡å•ä½æ ¹ä¸Šçš„å–å€¼å‘é‡ä¸º
$$
\begin{bmatrix}
P(\omega^{0})\\
P(\omega^{1})\\
\vdots\\
P(\omega^{n-1})
\end{bmatrix}
=
\underbrace{\begin{bmatrix}
1 & 1 & 1 & \cdots & 1\\
1 & \omega & \omega^2 & \cdots & \omega^{n-1}\\
1 & \omega^2 & \omega^{4} & \cdots & \omega^{2(n-1)}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
1 & \omega^{n-1} & \omega^{2(n-1)} & \cdots & \omega^{(n-1)(n-1)}
\end{bmatrix}}_{\text{DFT çŸ©é˜µ }F_n}
\!
\begin{bmatrix}
p_0\\ p_1\\ \vdots\\ p_{n-1}
\end{bmatrix}.
$$
è®°ä¸ºï¼š$\mathrm{FFT}(\langle \text{coeffs}\rangle)\to\langle \text{values}\rangle$ï¼Œå…¶ä¸­ $\omega=e^{2\pi i/n}$ã€‚

2. é€†å˜æ¢ï¼ˆæ’å€¼ / IFFTï¼‰

DFT çŸ©é˜µæ»¡è¶³ $F_n^{-1}=\frac{1}{n}\overline{F_n}$ã€‚å› æ­¤
$$
\begin{bmatrix}
p_0\\ p_1\\ \vdots\\ p_{n-1}
\end{bmatrix}
=
\frac{1}{n}
\underbrace{\begin{bmatrix}
1 & 1 & 1 & \cdots & 1\\
1 & \omega^{-1} & \omega^{-2} & \cdots & \omega^{-(n-1)}\\
1 & \omega^{-2} & \omega^{-4} & \cdots & \omega^{-2(n-1)}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
1 & \omega^{-(n-1)} & \omega^{-2(n-1)} & \cdots & \omega^{-(n-1)(n-1)}
\end{bmatrix}}_{F_n^{-1}}
\!
\begin{bmatrix}
P(\omega^{0})\\
P(\omega^{1})\\
\vdots\\
P(\omega^{n-1})
\end{bmatrix}.
$$

> è®°å¿†æ³•ï¼š$\mathrm{IFFT}(\langle \text{values}\rangle)$ ç­‰ä»·äºç”¨ $\omega'=e^{-\frac{2\pi i}{n}}$ åšä¸€æ¬¡ FFTï¼Œç„¶åæ•´ä½“ä¹˜ä»¥ $1/n$ï¼š
> $$
> \mathrm{IFFT}(v)=\frac1n\,\mathrm{FFT}_{\omega'}(v).
> $$

---

3. Cooleyâ€“Tukey é€’å½’ï¼ˆå¶/å¥‡æ‹†åˆ† + è¶å½¢ï¼‰

æŠŠ $P(x)$ æ‹†ä¸ºå¶/å¥‡æ¬¡ï¼š
$$
P(x)=P_e(x^2)+x\,P_o(x^2),\quad
P_e(x)=\sum_{k}p_{2k}x^k,\quad
P_o(x)=\sum_{k}p_{2k+1}x^k.
$$
åœ¨ $\omega^j$ ä¸Šï¼š
$$
P(\omega^j)=E_j+\omega^j O_j,\qquad
P(\omega^{j+n/2})=E_j-\omega^j O_j,\quad j=0,\ldots,n/2-1.
$$
å…¶ä¸­ $E_j=P_e(\omega_{n/2}^j),\;O_j=P_o(\omega_{n/2}^j)$ã€‚

äºæ˜¯é€’æ¨
$$
T(n)=2T(n/2)+\Theta(n)\;\Rightarrow\;T(n)=\Theta(n\log n).
$$

#### å¿«é€Ÿæ•°è®ºå˜åŒ–ï¼ˆDTTï¼‰ï¼ˆFast Number-Theoretic Transformï¼ŒFNTï¼‰



#### å‰©ä½™ç±»ï¼ˆåŒä½™ç±»ï¼‰

#### å®Œå…¨å‰©ä½™ç³»ï¼ˆå®Œç³»ï¼‰

#### ç®€åŒ–å‰©ä½™ç³»ï¼ˆç¼©ç³»ï¼‰

